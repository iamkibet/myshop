import{r as g,j as e,ag as re,ah as be,ai as le,aj as ne,ak as fe,al as de,am as ye,an as ie,ao as Ne,ap as ce,aq as oe,ar as ve,aa as A,as as we,at as xe,au as ke,av as Ce,a5 as _e,a7 as me,aw as Se,ax as Ee,ay as ge,af as H,az as se,z as he,q as y,aA as K,aB as Fe,aC as Te,v as F,aD as te,E as q,H as Ae,aE as De,X as R,K as ae,ab as Pe,aF as $e,aG as Le,aH as G,a3 as J,aI as Me,aJ as Re}from"./vendor-react-NdMTiU_3.js";import{c as _,C as N,a as v,A as W,b as $,d as L,e as M,I as T,B as x,f as P,g as C}from"./dashboard-BRRSZ3Kr.js";import{C as ze,A as Be,p as Ie,a as Oe}from"./vendor-charts-wdNP6emn.js";const X=ke,Y=Ce,U=g.forwardRef(({className:s,children:n,...a},c)=>e.jsxs(re,{ref:c,className:_("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",s),...a,children:[n,e.jsx(be,{asChild:!0,children:e.jsx(le,{className:"h-4 w-4 opacity-50"})})]}));U.displayName=re.displayName;const pe=g.forwardRef(({className:s,...n},a)=>e.jsx(ne,{ref:a,className:_("flex cursor-default items-center justify-center py-1",s),...n,children:e.jsx(fe,{className:"h-4 w-4"})}));pe.displayName=ne.displayName;const ue=g.forwardRef(({className:s,...n},a)=>e.jsx(de,{ref:a,className:_("flex cursor-default items-center justify-center py-1",s),...n,children:e.jsx(le,{className:"h-4 w-4"})}));ue.displayName=de.displayName;const V=g.forwardRef(({className:s,children:n,position:a="popper",...c},o)=>e.jsx(ye,{children:e.jsxs(ie,{ref:o,className:_("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:a,...c,children:[e.jsx(pe,{}),e.jsx(Ne,{className:_("p-1",a==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:n}),e.jsx(ue,{})]})}));V.displayName=ie.displayName;const Ue=g.forwardRef(({className:s,...n},a)=>e.jsx(ce,{ref:a,className:_("py-1.5 pl-8 pr-2 text-sm font-semibold",s),...n}));Ue.displayName=ce.displayName;const E=g.forwardRef(({className:s,children:n,...a},c)=>e.jsxs(oe,{ref:c,className:_("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...a,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(ve,{children:e.jsx(A,{className:"h-4 w-4"})})}),e.jsx(we,{children:n})]}));E.displayName=oe.displayName;const Ve=g.forwardRef(({className:s,...n},a)=>e.jsx(xe,{ref:a,className:_("-mx-1 my-1 h-px bg-muted",s),...n}));Ve.displayName=xe.displayName;const He=s=>new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES",minimumFractionDigits:0,maximumFractionDigits:0}).format(s),We=s=>s>=1e6?`${(s/1e6).toFixed(1)}M`:s>=1e3?`${(s/1e3).toFixed(1)}K`:s.toString();function D({title:s,value:n,change:a,changeType:c,icon:o,color:h,bgColor:i,format:j="currency",tooltip:r}){const[l,m]=g.useState(!1),[f,w]=g.useState(null),b=c==="increase",d=t=>j==="number"?We(t):He(t),S=()=>{f&&(clearTimeout(f),w(null)),m(!0)},B=()=>{m(!1)},I=()=>{f&&(clearTimeout(f),w(null)),m(!l)},Q=()=>{const t=setTimeout(()=>{m(!0)},500);w(t)},Z=()=>{f&&(clearTimeout(f),w(null))};return e.jsx(N,{className:`${i} text-white border-0 shadow-lg relative`,children:e.jsxs(v,{className:"px-3 py-2 sm:px-4 sm:py-3 lg:px-6 lg:py-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1 sm:mb-2",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("p",{className:"text-xs sm:text-sm font-medium opacity-90 truncate",children:s}),r&&e.jsxs("div",{className:"relative",children:[e.jsx("button",{className:"flex-shrink-0 ml-1 p-1 rounded-full hover:bg-white/20 active:bg-white/30 transition-colors cursor-help touch-manipulation",onClick:I,onMouseEnter:S,onMouseLeave:B,onTouchStart:Q,onTouchEnd:Z,children:e.jsx(_e,{className:"h-3 w-3 sm:h-4 sm:w-4 opacity-70"})}),l&&e.jsxs("div",{className:"fixed sm:absolute top-1/2 sm:top-full left-1/2 transform -translate-x-1/2 -translate-y-1/2 sm:translate-y-0 sm:mt-2 px-4 py-3 bg-gray-900 text-white text-xs sm:text-sm rounded-xl shadow-2xl z-50 w-80 sm:w-72 text-center sm:text-left",children:[e.jsx("div",{className:"font-semibold mb-2 text-white",children:s}),e.jsx("div",{className:"text-gray-200 leading-relaxed text-xs sm:text-sm",children:r}),e.jsx("div",{className:"hidden sm:block absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-4 border-r-4 border-b-4 border-transparent border-b-gray-900"})]})]})]}),e.jsx(o,{className:"h-4 w-4 sm:h-5 sm:w-5 lg:h-6 lg:w-6 opacity-80 flex-shrink-0 ml-2"})]}),e.jsx("p",{className:"text-lg sm:text-xl lg:text-2xl font-bold mb-1 sm:mb-2 truncate",children:d(n)})]})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[b?e.jsx(me,{className:"h-3 w-3 sm:h-4 sm:w-4"}):e.jsx(Se,{className:"h-3 w-3 sm:h-4 sm:w-4"}),e.jsxs("span",{className:"text-xs sm:text-sm font-medium",children:[Math.abs(a),"%"]})]}),e.jsx("span",{className:"text-xs sm:text-sm opacity-75",children:"vs Last Month"})]})]})})}function u({className:s,...n}){return e.jsx(Ee,{"data-slot":"label",className:_("text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",s),...n})}const z=g.forwardRef(({className:s,...n},a)=>e.jsx("textarea",{className:_("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:a,...n}));z.displayName="Textarea";function Ke({categories:s,userRole:n}){const{data:a,setData:c,post:o,processing:h,errors:i}=ge({title:"",description:"",amount:"",category:"",expense_date:"",receipt:null}),j=l=>{l.preventDefault(),o("/expenses")},r=l=>{const m=l.target.files?.[0]||null;c("receipt",m)};return e.jsxs(W,{children:[e.jsx(H,{title:"Add Expense"}),e.jsxs("div",{className:"mx-auto max-w-2xl space-y-4 sm:space-y-6 px-3 sm:px-0 pb-20 sm:pb-6",children:[e.jsxs("div",{className:"text-center sm:text-left",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold tracking-tight",children:"Add Expense"}),e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground mt-2",children:n==="manager"?"Record your expense with proof of purchase":"Record a new expense for the shop"})]}),e.jsxs(N,{children:[e.jsxs($,{children:[e.jsx(L,{className:"text-lg sm:text-xl",children:"Expense Details"}),e.jsx(M,{className:"text-sm",children:n==="manager"?"Fill in the details and attach proof of your expense":"Fill in the details for the new expense"})]}),e.jsx(v,{children:e.jsxs("form",{onSubmit:j,className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"grid gap-4 grid-cols-1 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx(u,{htmlFor:"title",className:"text-sm font-medium",children:"Title *"}),e.jsx(T,{id:"title",value:a.title,onChange:l=>c("title",l.target.value),placeholder:"e.g., Monthly Rent",className:"mt-1"}),i.title&&e.jsx("p",{className:"mt-1 text-xs sm:text-sm text-destructive",children:i.title})]}),e.jsxs("div",{children:[e.jsx(u,{htmlFor:"amount",className:"text-sm font-medium",children:"Amount *"}),e.jsx(T,{id:"amount",type:"number",step:"0.01",min:"0.01",value:a.amount,onChange:l=>c("amount",l.target.value),placeholder:"0.00",className:"mt-1"}),i.amount&&e.jsx("p",{className:"mt-1 text-xs sm:text-sm text-destructive",children:i.amount})]})]}),e.jsxs("div",{className:"grid gap-4 grid-cols-1 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx(u,{htmlFor:"category",className:"text-sm font-medium",children:"Category *"}),e.jsxs(X,{value:a.category,onValueChange:l=>c("category",l),children:[e.jsx(U,{className:"mt-1",children:e.jsx(Y,{placeholder:"Select category"})}),e.jsx(V,{children:Object.entries(s).map(([l,m])=>e.jsx(E,{value:l,children:m},l))})]}),i.category&&e.jsx("p",{className:"mt-1 text-xs sm:text-sm text-destructive",children:i.category})]}),e.jsxs("div",{children:[e.jsx(u,{htmlFor:"expense_date",className:"text-sm font-medium",children:"Expense Date *"}),e.jsx(T,{id:"expense_date",type:"date",value:a.expense_date,onChange:l=>c("expense_date",l.target.value),className:"mt-1"}),i.expense_date&&e.jsx("p",{className:"mt-1 text-xs sm:text-sm text-destructive",children:i.expense_date})]})]}),e.jsxs("div",{children:[e.jsx(u,{htmlFor:"description",className:"text-sm font-medium",children:"Description"}),e.jsx(z,{id:"description",value:a.description,onChange:l=>c("description",l.target.value),placeholder:"Optional description of the expense...",rows:3,className:"mt-1"}),i.description&&e.jsx("p",{className:"mt-1 text-xs sm:text-sm text-destructive",children:i.description})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(u,{htmlFor:"receipt",className:"text-sm font-medium",children:n==="manager"?"Proof of Purchase *":"Receipt (Optional)"}),e.jsx("div",{className:"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-4 sm:p-6 text-center hover:border-gray-400 dark:hover:border-gray-500 transition-colors",children:e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"mx-auto w-12 h-12 sm:w-16 sm:h-16 bg-gray-100 dark:bg-gray-800 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 sm:w-8 sm:h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm sm:text-base font-medium text-gray-900 dark:text-gray-100",children:n==="manager"?"Upload proof of purchase":"Upload receipt"}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-500 dark:text-gray-400 mt-1",children:n==="manager"?"Take a photo or upload a screenshot of your receipt/invoice":"Drag and drop or click to upload"})]}),e.jsx(T,{id:"receipt",type:"file",accept:".jpg,.jpeg,.png,.pdf",onChange:r,className:"hidden"}),e.jsx(x,{type:"button",variant:"outline",onClick:()=>document.getElementById("receipt")?.click(),className:"mx-auto",children:"Choose File"}),a.receipt&&e.jsx("div",{className:"mt-3 p-3 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-center space-x-2 text-green-700 dark:text-green-300",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),e.jsxs("span",{className:"text-sm font-medium",children:[a.receipt.name," selected"]})]})})]})}),e.jsx("div",{className:"text-center",children:e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Accepted formats: JPG, PNG, PDF",n==="manager"&&e.jsx("span",{className:"block mt-1 text-amber-600 dark:text-amber-400 font-medium",children:"âš ï¸ Proof of purchase is required for manager expenses"})]})}),i.receipt&&e.jsx("p",{className:"mt-1 text-xs sm:text-sm text-destructive text-center",children:i.receipt})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center justify-end space-y-2 sm:space-y-0 sm:space-x-2 pt-4",children:[e.jsx(x,{type:"button",variant:"outline",onClick:()=>window.history.back(),className:"w-full sm:w-auto",children:"Cancel"}),e.jsx(x,{type:"submit",disabled:h,className:"w-full sm:w-auto",children:h?e.jsxs(e.Fragment,{children:[e.jsx(se,{className:"mr-2 h-4 w-4 animate-spin"}),"Adding..."]}):e.jsxs(e.Fragment,{children:[e.jsx(he,{className:"mr-2 h-4 w-4"}),"Add Expense"]})})]})]})})]})]})]})}const es=Object.freeze(Object.defineProperty({__proto__:null,default:Ke},Symbol.toStringTag,{value:"Module"}));function qe({expense:s,categories:n,userRole:a}){const[c,o]=g.useState(!1),{data:h,setData:i,put:j,processing:r,errors:l}=ge({title:s.title,description:s.description||"",amount:s.amount.toString(),category:s.category,expense_date:s.expense_date,receipt:null}),m=d=>{d.preventDefault(),j(`/expenses/${s.id}`)},f=d=>{const S=d.target.files?.[0]||null;i("receipt",S)},w=async()=>{if(confirm("Are you sure you want to delete this expense? This action cannot be undone.")){o(!0);try{await F.delete(`/expenses/${s.id}`)}finally{o(!1)}}},b=s.status==="pending"||a==="admin";return e.jsxs(W,{children:[e.jsx(H,{title:`Edit Expense: ${s.title}`}),e.jsxs("div",{className:"mx-auto max-w-2xl space-y-4 sm:space-y-6 px-3 sm:px-0 pb-20 sm:pb-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{className:"text-center sm:text-left",children:[e.jsxs("div",{className:"flex items-center justify-center sm:justify-start gap-3 mb-2",children:[e.jsx(y,{href:"/expenses",className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:e.jsx(K,{className:"h-5 w-5"})}),e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold tracking-tight",children:"Edit Expense"})]}),e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground",children:a==="manager"?"Update your expense details":"Update expense information"})]}),b&&e.jsx(x,{variant:"destructive",size:"sm",onClick:w,disabled:c,className:"w-full sm:w-auto",children:c?e.jsxs(e.Fragment,{children:[e.jsx(se,{className:"mr-2 h-4 w-4 animate-spin"}),"Deleting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Fe,{className:"mr-2 h-4 w-4"}),"Delete"]})})]}),!b&&e.jsx(N,{className:"border-amber-200 bg-amber-50 dark:border-amber-800 dark:bg-amber-900/20",children:e.jsx(v,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-5 h-5 rounded-full bg-amber-500 flex items-center justify-center",children:e.jsx("span",{className:"text-white text-xs",children:"!"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-amber-800 dark:text-amber-200",children:"Cannot Edit Expense"}),e.jsxs("p",{className:"text-xs text-amber-700 dark:text-amber-300 mt-1",children:["This expense has been ",s.status," and cannot be modified."]})]})]})})}),e.jsxs(N,{children:[e.jsxs($,{children:[e.jsx(L,{className:"text-lg sm:text-xl",children:"Expense Details"}),e.jsx(M,{className:"text-sm",children:a==="manager"?"Update the details and proof of your expense":"Update the expense information"})]}),e.jsx(v,{children:e.jsxs("form",{onSubmit:m,className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"grid gap-4 grid-cols-1 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx(u,{htmlFor:"title",className:"text-sm font-medium",children:"Title *"}),e.jsx(T,{id:"title",value:h.title,onChange:d=>i("title",d.target.value),placeholder:"e.g., Monthly Rent",className:"mt-1",disabled:!b}),l.title&&e.jsx("p",{className:"mt-1 text-xs sm:text-sm text-destructive",children:l.title})]}),e.jsxs("div",{children:[e.jsx(u,{htmlFor:"amount",className:"text-sm font-medium",children:"Amount *"}),e.jsx(T,{id:"amount",type:"number",step:"0.01",min:"0.01",value:h.amount,onChange:d=>i("amount",d.target.value),placeholder:"0.00",className:"mt-1",disabled:!b}),l.amount&&e.jsx("p",{className:"mt-1 text-xs sm:text-sm text-destructive",children:l.amount})]})]}),e.jsxs("div",{className:"grid gap-4 grid-cols-1 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx(u,{htmlFor:"category",className:"text-sm font-medium",children:"Category *"}),e.jsxs(X,{value:h.category,onValueChange:d=>i("category",d),disabled:!b,children:[e.jsx(U,{className:"mt-1",children:e.jsx(Y,{placeholder:"Select category"})}),e.jsx(V,{children:Object.entries(n).map(([d,S])=>e.jsx(E,{value:d,children:S},d))})]}),l.category&&e.jsx("p",{className:"mt-1 text-xs sm:text-sm text-destructive",children:l.category})]}),e.jsxs("div",{children:[e.jsx(u,{htmlFor:"expense_date",className:"text-sm font-medium",children:"Expense Date *"}),e.jsx(T,{id:"expense_date",type:"date",value:h.expense_date,onChange:d=>i("expense_date",d.target.value),className:"mt-1",disabled:!b}),l.expense_date&&e.jsx("p",{className:"mt-1 text-xs sm:text-sm text-destructive",children:l.expense_date})]})]}),e.jsxs("div",{children:[e.jsx(u,{htmlFor:"description",className:"text-sm font-medium",children:"Description"}),e.jsx(z,{id:"description",value:h.description,onChange:d=>i("description",d.target.value),placeholder:"Additional details about the expense...",className:"mt-1",rows:3,disabled:!b}),l.description&&e.jsx("p",{className:"mt-1 text-xs sm:text-sm text-destructive",children:l.description})]}),s.receipt_path&&e.jsxs("div",{className:"space-y-3",children:[e.jsx(u,{className:"text-sm font-medium",children:"Current Receipt"}),e.jsx("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-4 bg-gray-50 dark:bg-gray-800",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 dark:bg-blue-900/20 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-5 h-5 text-blue-600 dark:text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:"Receipt attached"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Current proof of purchase"})]})]}),e.jsx(y,{href:`/expenses/${s.id}/receipt`,target:"_blank",className:"text-blue-600 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 text-sm font-medium",children:"View"})]})})]}),b&&e.jsxs("div",{className:"space-y-3",children:[e.jsx(u,{htmlFor:"receipt",className:"text-sm font-medium",children:a==="manager"?"Update Proof of Purchase":"Update Receipt"}),e.jsx("div",{className:"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-4 sm:p-6 text-center hover:border-gray-400 dark:hover:border-gray-500 transition-colors",children:e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"mx-auto w-12 h-12 sm:w-16 sm:h-16 bg-gray-100 dark:bg-gray-800 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 sm:w-8 sm:h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm sm:text-base font-medium text-gray-900 dark:text-gray-100",children:a==="manager"?"Upload new proof of purchase":"Upload new receipt"}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-500 dark:text-gray-400 mt-1",children:a==="manager"?"Take a photo or upload a screenshot of your receipt/invoice":"Drag and drop or click to upload"})]}),e.jsx(T,{id:"receipt",type:"file",accept:".jpg,.jpeg,.png,.pdf",onChange:f,className:"hidden"}),e.jsx(x,{type:"button",variant:"outline",onClick:()=>document.getElementById("receipt")?.click(),className:"mx-auto",children:"Choose File"}),h.receipt&&e.jsx("div",{className:"mt-3 p-3 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-center space-x-2 text-green-700 dark:text-green-300",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),e.jsxs("span",{className:"text-sm font-medium",children:[h.receipt.name," selected"]})]})})]})}),e.jsx("div",{className:"text-center",children:e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Accepted formats: JPG, PNG, PDF",a==="manager"&&e.jsx("span",{className:"block mt-1 text-amber-600 dark:text-amber-400 font-medium",children:"âš ï¸ Proof of purchase is required for manager expenses"})]})}),l.receipt&&e.jsx("p",{className:"mt-1 text-xs sm:text-sm text-destructive text-center",children:l.receipt})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center justify-end space-y-2 sm:space-y-0 sm:space-x-2 pt-4",children:[e.jsx(y,{href:"/expenses",className:"w-full sm:w-auto",children:e.jsx(x,{type:"button",variant:"outline",className:"w-full sm:w-auto",children:"Cancel"})}),b&&e.jsx(x,{type:"submit",disabled:r,className:"w-full sm:w-auto",children:r?e.jsxs(e.Fragment,{children:[e.jsx(se,{className:"mr-2 h-4 w-4 animate-spin"}),"Updating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Te,{className:"mr-2 h-4 w-4"}),"Update Expense"]})})]})]})})]})]})]})}const ss=Object.freeze(Object.defineProperty({__proto__:null,default:qe},Symbol.toStringTag,{value:"Module"}));ze.register(Be,Ie,Oe);function Ge({expenses:s,categories:n,summary:a,filters:c,userRole:o,pendingExpensesCount:h}){const[i,j]=g.useState(c.search||""),[r,l]=g.useState(c.category||"all"),[m,f]=g.useState(c.status||"all"),w=()=>{F.get("/expenses",{search:i,category:r==="all"?void 0:r,status:m==="all"?void 0:m},{preserveState:!0,preserveScroll:!0})},b=()=>{j(""),l("all"),f("all"),F.get("/expenses")},d=t=>{confirm("Are you sure you want to approve this expense?")&&F.post(`/expenses/${t}/approve`)},S=t=>{confirm("Are you sure you want to reject this expense?")&&F.post(`/expenses/${t}/reject`)},B=t=>({rent:"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-400",utilities:"bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-400",inventory:"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400",maintenance:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-400",marketing:"bg-purple-100 text-purple-800 dark:bg-purple-900/20 dark:text-purple-400",other:"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-400"})[t]||"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-400",I=t=>{const p={rent:"#EF4444",utilities:"#3B82F6",inventory:"#10B981",maintenance:"#F59E0B",marketing:"#8B5CF6",other:"#6B7280"};return p[t]||p.other},Q=()=>{if(!a.category_totals||a.category_totals.length===0)return{labels:[],datasets:[{data:[],backgroundColor:[],borderColor:[],borderWidth:1}]};const t=a.category_totals.map(k=>n[k.category]||k.category),p=a.category_totals.map(k=>k.total),O=a.category_totals.map(k=>I(k.category)),ee=a.category_totals.map(k=>I(k.category));return{labels:t,datasets:[{data:p,backgroundColor:O,borderColor:ee,borderWidth:2,hoverOffset:4}]}},Z={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{usePointStyle:!0,pointStyle:"circle",padding:20,font:{size:12,family:"Inter, sans-serif",weight:"normal"},color:"#374151"}},tooltip:{backgroundColor:"rgba(31, 41, 55, 0.95)",titleColor:"#D1D5DB",bodyColor:"#FFFFFF",borderColor:"#374151",borderWidth:1,cornerRadius:8,displayColors:!0,padding:12,titleFont:{size:13,weight:"normal"},bodyFont:{size:14,weight:"bold"},callbacks:{label:function(t){const p=t.parsed,O=t.dataset.data.reduce((k,je)=>k+je,0),ee=(p/O*100).toFixed(1);return`${t.label}: Ksh ${p.toLocaleString()} (${ee}%)`}}}}};return e.jsxs(W,{children:[e.jsx(H,{title:"Expenses"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 sm:gap-6 overflow-x-auto rounded-xl p-3 sm:p-4 bg-gray-50 pb-24 sm:pb-4",children:[e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:o==="manager"?"My Expenses":"Expenses Management"}),e.jsx("p",{className:"text-sm sm:text-base text-gray-600 mt-1",children:o==="manager"?"Track and manage your personal expenses with proof of purchase":"Track and manage your shop expenses with detailed analytics"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-3 w-full sm:w-auto",children:[e.jsx(y,{href:"/expenses/create",className:"w-full sm:w-auto",children:e.jsxs(x,{size:"lg",className:"w-full",children:[e.jsx(he,{className:"mr-2 h-4 w-4 sm:h-5 sm:w-5"}),"Add New Expense"]})}),o==="admin"&&h>0&&e.jsx(y,{href:"/expenses/pending/approval",className:"w-full sm:w-auto",children:e.jsxs(x,{variant:"outline",size:"lg",className:"w-full bg-amber-50 border-amber-200 text-amber-700 hover:bg-amber-100",children:[e.jsx(te,{className:"mr-2 h-4 w-4 sm:h-5 sm:w-5"}),h," Pending"]})})]})]})}),o==="admin"?e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4 lg:gap-6",children:[e.jsx(D,{title:"Total Expenses",value:a.total_expenses,change:15,changeType:"increase",icon:q,color:"red",bgColor:"bg-red-800",tooltip:"Total amount spent on all business expenses including rent, utilities, inventory, maintenance, and other operational costs."}),e.jsx(D,{title:"Total Sales",value:a.total_sales||0,change:25,changeType:"increase",icon:me,color:"green",bgColor:"bg-green-800",tooltip:"Total revenue generated from all completed sales transactions. This represents your gross income before expenses."}),e.jsx(D,{title:"Net Profit",value:a.total_profit||0,change:8,changeType:"increase",icon:Ae,color:"blue",bgColor:"bg-blue-800",tooltip:"Net profit calculated as total sales minus total expenses. This shows your actual business profitability."}),e.jsx(D,{title:"Profit Margin",value:a.net_profit_margin||0,change:5,changeType:"increase",icon:De,color:"blue",bgColor:"bg-gray-900",format:"number",tooltip:"Net profit margin as a percentage of total sales. Higher percentages indicate better profitability efficiency."})]}):e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4 lg:gap-6",children:[e.jsx(D,{title:"My Total Expenses",value:a.total_expenses,change:12,changeType:"increase",icon:q,color:"red",bgColor:"bg-red-800",tooltip:"Total amount of expenses you have submitted for approval. This includes all your expense claims."}),e.jsx(D,{title:"Pending Expenses",value:s.data.filter(t=>t.status==="pending").length,change:3,changeType:"increase",icon:te,color:"yellow",bgColor:"bg-yellow-600",format:"number",tooltip:"Number of your expense claims that are currently awaiting approval from administrators."}),e.jsx(D,{title:"Approved Expenses",value:s.data.filter(t=>t.status==="approved").length,change:18,changeType:"increase",icon:A,color:"green",bgColor:"bg-green-800",format:"number",tooltip:"Number of your expense claims that have been successfully approved by administrators."}),e.jsx(D,{title:"Rejected Expenses",value:s.data.filter(t=>t.status==="rejected").length,change:2,changeType:"increase",icon:R,color:"red",bgColor:"bg-red-600",format:"number",tooltip:"Number of your expense claims that have been rejected by administrators and need to be resubmitted."})]}),o==="admin"&&e.jsxs(N,{className:"bg-white border-0 shadow-sm",children:[e.jsxs($,{className:"pb-3 sm:pb-4",children:[e.jsxs(L,{className:"text-lg sm:text-xl font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(ae,{className:"h-5 w-5"}),"Business Health Overview"]}),e.jsx(M,{className:"text-gray-600",children:"Key performance indicators and expense efficiency metrics"})]}),e.jsxs(v,{children:[e.jsxs("div",{className:"grid gap-4 sm:gap-6 grid-cols-1 sm:grid-cols-2 lg:grid-cols-4",children:[e.jsxs("div",{className:"text-center p-4 rounded-lg bg-blue-50 border border-blue-200",children:[e.jsxs("div",{className:"text-2xl sm:text-3xl font-bold text-blue-900 mb-2",children:[a.total_sales&&a.total_sales>0?(a.total_expenses/a.total_sales*100).toFixed(1):0,"%"]}),e.jsx("p",{className:"text-sm text-blue-700 font-medium",children:"Expense Ratio"}),e.jsx("p",{className:"text-xs text-blue-600 mt-1",children:"Expenses as % of sales"})]}),e.jsxs("div",{className:"text-center p-4 rounded-lg bg-purple-50 border border-purple-200",children:[e.jsx("div",{className:"text-2xl sm:text-3xl font-bold text-purple-900 mb-2",children:P(a.monthly_expenses&&a.monthly_expenses.length>0?a.monthly_expenses.reduce((t,p)=>t+p.total,0)/a.monthly_expenses.length:0)}),e.jsx("p",{className:"text-sm text-purple-700 font-medium",children:"Avg Monthly Expenses"}),e.jsx("p",{className:"text-xs text-purple-600 mt-1",children:"Based on available data"})]}),e.jsxs("div",{className:"text-center p-4 rounded-lg bg-orange-50 border border-orange-200",children:[e.jsx("div",{className:"text-2xl sm:text-3xl font-bold text-orange-900 mb-2",children:a.category_totals&&a.category_totals.length>0?(a.category_totals[0].total/a.total_expenses*100).toFixed(0)+"%":"0%"}),e.jsx("p",{className:"text-sm text-orange-700 font-medium",children:"Top Category"}),e.jsx("p",{className:"text-xs text-orange-600 mt-1",children:a.category_totals&&a.category_totals.length>0?n[a.category_totals[0].category]||a.category_totals[0].category:"No data"})]}),e.jsxs("div",{className:"text-center p-4 rounded-lg bg-green-50 border border-green-200",children:[e.jsx("div",{className:"text-2xl sm:text-3xl font-bold text-green-900 mb-2",children:"+12%"}),e.jsx("p",{className:"text-sm text-green-700 font-medium",children:"Growth Rate"}),e.jsx("p",{className:"text-xs text-green-600 mt-1",children:"Month-over-month"})]})]}),a.monthly_expenses&&a.monthly_expenses.length>0&&e.jsxs("div",{className:"mt-6",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-4 text-center sm:text-left",children:"Monthly Expense Trends"}),e.jsx("div",{className:"grid gap-3 grid-cols-2 sm:grid-cols-3 lg:grid-cols-6",children:a.monthly_expenses.slice(-6).map((t,p)=>{const O=new Date(2024,t.month-1).toLocaleDateString("en-US",{month:"short"});return e.jsxs("div",{className:"text-center p-3 rounded-lg bg-gray-50 border border-gray-200",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900 mb-1",children:O}),e.jsx("div",{className:"text-lg font-bold text-gray-900",children:P(t.total)}),e.jsx("div",{className:"text-xs text-gray-600",children:"Expenses"})]},p)})})]})]})]}),e.jsxs(N,{className:"bg-white border-0 shadow-sm",children:[e.jsxs($,{className:"pb-3 sm:pb-4",children:[e.jsx(L,{className:"text-lg sm:text-xl font-semibold text-gray-900",children:"Search & Filter"}),e.jsx(M,{className:"text-gray-600",children:"Find and filter expenses by category, status, or search terms"})]}),e.jsx(v,{children:e.jsxs("div",{className:"flex flex-col gap-3 sm:gap-4 lg:flex-row lg:items-center lg:space-x-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Pe,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-gray-400"}),e.jsx(T,{placeholder:"Search expenses by title, description, or amount...",value:i,onChange:t=>j(t.target.value),className:"pl-10 h-10 sm:h-11 text-sm"})]}),e.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row",children:[e.jsx("div",{className:"w-full sm:w-48",children:e.jsxs(X,{value:r,onValueChange:l,children:[e.jsx(U,{className:"h-10 sm:h-11",children:e.jsx(Y,{placeholder:"Category"})}),e.jsxs(V,{children:[e.jsx(E,{value:"all",children:"All Categories"}),Object.entries(n).map(([t,p])=>e.jsx(E,{value:t,children:p},t))]})]})}),e.jsx("div",{className:"w-full sm:w-48",children:e.jsxs(X,{value:m,onValueChange:f,children:[e.jsx(U,{className:"h-10 sm:h-11",children:e.jsx(Y,{placeholder:"Status"})}),e.jsxs(V,{children:[e.jsx(E,{value:"all",children:"All Statuses"}),e.jsx(E,{value:"pending",children:"Pending"}),e.jsx(E,{value:"approved",children:"Approved"}),e.jsx(E,{value:"rejected",children:"Rejected"})]})]})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(x,{onClick:w,size:"sm",className:"h-10 sm:h-11 px-4",children:[e.jsx($e,{className:"h-4 w-4 mr-2"}),"Filter"]}),e.jsx(x,{onClick:b,variant:"outline",size:"sm",className:"h-10 sm:h-11 px-4",children:"Reset"})]})]})})]}),o==="admin"&&a.category_totals&&a.category_totals.length>0&&e.jsxs(N,{className:"bg-white border-0 shadow-sm",children:[e.jsxs($,{className:"pb-3 sm:pb-4",children:[e.jsxs(L,{className:"text-lg sm:text-xl font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(ae,{className:"h-5 w-5"}),"Expenses by Category"]}),e.jsx(M,{className:"text-gray-600",children:"Visual breakdown of expenses by category"})]}),e.jsx(v,{children:e.jsxs("div",{className:"grid gap-6 sm:gap-8 grid-cols-1 lg:grid-cols-2",children:[e.jsx("div",{className:"flex flex-col items-center justify-center p-4 bg-gray-50 rounded-lg",children:e.jsx("div",{className:"w-full h-80 flex items-center justify-center",children:a.category_totals&&a.category_totals.length>0?e.jsx(Le,{data:Q(),options:Z}):e.jsxs("div",{className:"text-center text-gray-500",children:[e.jsx("div",{className:"text-4xl mb-2",children:"ðŸ¥§"}),e.jsx("p",{className:"text-sm",children:"No category data available"})]})})}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-4",children:"Category Breakdown"}),e.jsx("div",{className:"space-y-3",children:a.category_totals.map((t,p)=>e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg border border-gray-200 bg-white hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0 flex-1",children:[e.jsx("div",{className:"w-4 h-4 rounded-full flex-shrink-0",style:{backgroundColor:I(t.category)}}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:n[t.category]||t.category}),e.jsxs("p",{className:"text-xs text-gray-500",children:[(t.total/a.total_expenses*100).toFixed(1),"% of total"]})]})]}),e.jsxs("div",{className:"text-right ml-2 flex-shrink-0",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:P(t.total)}),e.jsx(C,{className:`mt-1 text-xs ${B(t.category)}`,children:t.category})]})]},t.category))}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Total Categories:"}),e.jsx("span",{className:"font-semibold text-gray-900",children:a.category_totals.length})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm mt-1",children:[e.jsx("span",{className:"text-gray-600",children:"Total Expenses:"}),e.jsx("span",{className:"font-semibold text-gray-900",children:P(a.total_expenses)})]})]})]})]})})]}),e.jsxs(N,{className:"bg-white border-0 shadow-sm",children:[e.jsxs($,{className:"pb-3 sm:pb-4",children:[e.jsx(L,{className:"text-lg sm:text-xl font-semibold text-gray-900",children:o==="manager"?"My Expenses":"All Expenses"}),e.jsx(M,{className:"text-gray-600",children:o==="manager"?"Complete list of your expenses with proof of purchase":"Complete list of all expenses with details"})]}),e.jsxs(v,{children:[e.jsx("div",{className:"space-y-2 sm:space-y-3",children:s.data.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[e.jsx("div",{className:"text-4xl mb-2",children:"ðŸ’°"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Expenses Found"}),e.jsx("p",{className:"text-gray-500 text-sm max-w-sm",children:i||r!=="all"||m!=="all"?"Try adjusting your filters":"Start by adding your first expense"})]}):s.data.map(t=>e.jsxs("div",{className:"p-3 sm:p-4 border-b border-gray-100 last:border-b-0 hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"block sm:hidden",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-3 min-w-0 flex-1",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"h-8 w-8 bg-red-100 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-xs font-medium text-red-600",children:t.id})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:t.title}),e.jsx("p",{className:"text-lg font-bold text-gray-900 mt-1",children:P(t.amount)})]})]}),e.jsx(C,{className:`text-xs px-2 py-1 ${t.status==="approved"?"bg-green-100 text-green-800":t.status==="rejected"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:t.status==="approved"?"âœ“ Approved":t.status==="rejected"?"âœ— Rejected":"â³ Pending"})]}),e.jsxs("div",{className:"space-y-2 mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-4 text-xs text-gray-500",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(G,{className:"h-3 w-3"}),e.jsx("span",{children:new Date(t.expense_date).toLocaleDateString()})]}),e.jsx("div",{className:"flex items-center space-x-1",children:e.jsx("span",{className:"truncate",children:t.added_by.name})})]}),e.jsx("div",{className:"flex items-center space-x-1",children:e.jsx(C,{className:`text-xs px-2 py-0.5 ${B(t.category)}`,children:n[t.category]})})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(y,{href:`/expenses/${t.id}`,className:"flex-1",children:e.jsxs(x,{variant:"outline",size:"sm",className:"w-full h-8 text-xs",children:[e.jsx(J,{className:"h-3 w-3 mr-1"}),"View Details"]})}),o==="admin"&&t.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsx(x,{onClick:()=>d(t.id),size:"sm",className:"h-8 px-3 text-xs bg-green-600 hover:bg-green-700 text-white",children:e.jsx(A,{className:"h-3 w-3"})}),e.jsx(x,{onClick:()=>S(t.id),variant:"outline",size:"sm",className:"h-8 px-3 text-xs border-red-300 text-red-700 hover:bg-red-50",children:e.jsx(R,{className:"h-3 w-3"})})]})]})]}),e.jsxs("div",{className:"hidden sm:flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4 min-w-0 flex-1",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"h-10 w-10 bg-red-100 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-sm font-medium text-red-600",children:t.id})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:t.title}),e.jsxs("div",{className:"flex items-center space-x-4 text-xs text-gray-500 mt-1",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(G,{className:"h-3 w-3"}),e.jsx("span",{children:new Date(t.expense_date).toLocaleDateString()})]}),e.jsx("div",{className:"flex items-center space-x-1",children:e.jsx("span",{className:"truncate",children:t.added_by.name})}),e.jsx("div",{className:"flex items-center space-x-1",children:e.jsx(C,{className:`text-xs px-2 py-0.5 ${B(t.category)}`,children:n[t.category]})})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-4 flex-shrink-0",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:P(t.amount)}),e.jsx("div",{className:"flex items-center space-x-1 mt-1",children:e.jsx(C,{className:`text-xs px-2 py-0.5 ${t.status==="approved"?"bg-green-100 text-green-800":t.status==="rejected"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:t.status==="approved"?"âœ“ Approved":t.status==="rejected"?"âœ— Rejected":"â³ Pending"})})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(y,{href:`/expenses/${t.id}`,children:e.jsxs(x,{variant:"outline",size:"sm",className:"h-7 px-2 text-xs",children:[e.jsx(J,{className:"h-3 w-3 mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:"View"})]})}),o==="admin"&&t.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsxs(x,{onClick:()=>d(t.id),size:"sm",className:"h-7 px-2 text-xs bg-green-600 hover:bg-green-700 text-white",children:[e.jsx(A,{className:"h-3 w-3 mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:"Approve"})]}),e.jsxs(x,{onClick:()=>S(t.id),variant:"outline",size:"sm",className:"h-7 px-2 text-xs border-red-300 text-red-700 hover:bg-red-50",children:[e.jsx(R,{className:"h-3 w-3 mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:"Reject"})]})]})]})]})]})]},t.id))}),s.links&&s.links.length>3&&e.jsx("div",{className:"mt-6 pt-4 border-t border-gray-200",children:e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("nav",{className:"flex items-center gap-1 sm:gap-2",children:s.links.map((t,p)=>e.jsx(y,{href:t.url||"#",className:`px-2 sm:px-3 py-2 text-xs sm:text-sm font-medium rounded-md transition-colors ${t.active?"bg-blue-600 text-white":t.url?"text-gray-700 hover:bg-gray-100":"text-gray-400 cursor-not-allowed"}`,dangerouslySetInnerHTML:{__html:t.label}},p))})})})]})]})]})]})}const ts=Object.freeze(Object.defineProperty({__proto__:null,default:Ge},Symbol.toStringTag,{value:"Module"}));function Je({pendingExpenses:s}){const[n,a]=g.useState({}),[c,o]=g.useState({}),h=r=>{const l=n[r]||"";F.post(`/expenses/${r}/approve`,{approval_notes:l})},i=r=>{const l=c[r];if(!l||l.trim()===""){alert("Please provide a reason for rejection.");return}F.post(`/expenses/${r}/reject`,{approval_notes:l})},j=r=>({rent:"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-400",utilities:"bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-400",inventory:"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400",maintenance:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-400",marketing:"bg-purple-100 text-purple-800 dark:bg-purple-900/20 dark:text-purple-400",other:"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-400"})[r]||"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-400";return e.jsxs(W,{children:[e.jsx(H,{title:"Pending Expenses Approval"}),e.jsxs("div",{className:"container mx-auto px-3 sm:px-4 py-4 sm:py-8 max-w-7xl pb-20 sm:pb-6",children:[e.jsx("div",{className:"mb-6 sm:mb-8",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{className:"text-center sm:text-left",children:[e.jsxs("div",{className:"flex items-center justify-center sm:justify-start gap-3 mb-2",children:[e.jsx(y,{href:"/expenses",className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:e.jsx(K,{className:"h-5 w-5"})}),e.jsx("h1",{className:"text-2xl sm:text-3xl lg:text-4xl font-bold tracking-tight text-gray-900 dark:text-gray-100",children:"Pending Expenses Approval"})]}),e.jsx("p",{className:"text-sm sm:text-base lg:text-lg text-gray-600 dark:text-gray-400",children:"Review and approve manager expense submissions"})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(C,{variant:"outline",className:"bg-yellow-50 border-yellow-200 text-yellow-700",children:[s.data.length," Pending"]})})]})}),e.jsxs(N,{className:"border-0 shadow-sm bg-white dark:bg-gray-900 dark:border-gray-800",children:[e.jsxs($,{className:"pb-4",children:[e.jsx(L,{className:"text-base sm:text-lg font-semibold",children:"Pending Expenses"}),e.jsx(M,{className:"text-sm",children:"Review these expenses and approve or reject them with notes"})]}),e.jsxs(v,{children:[e.jsx("div",{className:"space-y-4",children:s.data.length===0?e.jsxs("div",{className:"py-12 text-center",children:[e.jsx(A,{className:"h-12 w-12 text-green-400 mx-auto mb-4"}),e.jsx("p",{className:"text-lg font-medium text-gray-500 dark:text-gray-400 mb-2",children:"No pending expenses"}),e.jsx("p",{className:"text-sm text-gray-400 dark:text-gray-500",children:"All expenses have been reviewed"})]}):s.data.map(r=>e.jsxs("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-4 sm:p-6 space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-start gap-3 mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:r.title}),e.jsx(C,{className:`${j(r.category)} text-xs px-2 py-1`,children:r.category})]}),r.description&&e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:r.description}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4 text-sm text-gray-500 dark:text-gray-400",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(G,{className:"h-4 w-4"}),new Date(r.expense_date).toLocaleDateString()]}),e.jsx("span",{children:"â€¢"}),e.jsxs("span",{children:["Submitted by ",r.added_by.name]}),e.jsx("span",{children:"â€¢"}),e.jsx("span",{children:r.added_by.email})]})]}),e.jsxs("div",{className:"text-center sm:text-right",children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:P(r.amount)}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Submitted ",new Date(r.created_at).toLocaleDateString()]})]})]}),r.receipt_path&&e.jsxs("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-3 bg-gray-50 dark:bg-gray-800",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(q,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Proof of Purchase"})]}),e.jsxs(y,{href:`/expenses/${r.id}/receipt`,target:"_blank",className:"text-blue-600 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 text-sm flex items-center gap-1",children:[e.jsx(J,{className:"h-4 w-4"}),"View Receipt"]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 pt-3 border-t border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(u,{htmlFor:`approval-notes-${r.id}`,className:"text-sm font-medium text-green-700 dark:text-green-300",children:"Approval Notes (Optional)"}),e.jsx(z,{id:`approval-notes-${r.id}`,placeholder:"Add approval notes...",value:n[r.id]||"",onChange:l=>a(m=>({...m,[r.id]:l.target.value})),className:"mt-1 border-green-200 focus:border-green-300",rows:2})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx(u,{htmlFor:`rejection-notes-${r.id}`,className:"text-sm font-medium text-red-700 dark:text-red-300",children:"Rejection Reason (Required for rejection)"}),e.jsx(z,{id:`rejection-notes-${r.id}`,placeholder:"Provide reason for rejection...",value:c[r.id]||"",onChange:l=>o(m=>({...m,[r.id]:l.target.value})),className:"mt-1 border-red-200 focus:border-red-300",rows:2})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 pt-3",children:[e.jsxs(x,{onClick:()=>h(r.id),className:"flex-1 bg-green-600 hover:bg-green-700 text-white",children:[e.jsx(A,{className:"mr-2 h-4 w-4"}),"Approve Expense"]}),e.jsxs(x,{onClick:()=>i(r.id),variant:"outline",className:"flex-1 border-red-200 text-red-700 hover:bg-red-50",children:[e.jsx(R,{className:"mr-2 h-4 w-4"}),"Reject Expense"]})]})]},r.id))}),s.links&&s.links.length>3&&e.jsx("div",{className:"mt-6 sm:mt-8 flex items-center justify-center",children:e.jsx("nav",{className:"flex items-center gap-1 sm:gap-2",children:s.links.map((r,l)=>e.jsx(y,{href:r.url||"#",className:`px-2 sm:px-3 py-2 text-xs sm:text-sm font-medium rounded-md transition-colors ${r.active?"bg-blue-600 text-white":r.url?"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800":"text-gray-400 dark:text-gray-600 cursor-not-allowed"}`,dangerouslySetInnerHTML:{__html:r.label}},l))})})]})]})]})]})}const as=Object.freeze(Object.defineProperty({__proto__:null,default:Je},Symbol.toStringTag,{value:"Module"}));function Xe({expense:s,userRole:n}){const[a,c]=g.useState(s.approval_notes||""),[o,h]=g.useState(""),[i,j]=g.useState(!1),r=async()=>{if(!i){j(!0);try{await F.post(`/expenses/${s.id}/approve`,{approval_notes:a})}finally{j(!1)}}},l=async()=>{if(!o.trim()){alert("Please provide a reason for rejection.");return}if(!i){j(!0);try{await F.post(`/expenses/${s.id}/reject`,{approval_notes:o})}finally{j(!1)}}},m=d=>({rent:"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-400",utilities:"bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-400",inventory:"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400",maintenance:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-400",marketing:"bg-purple-100 text-purple-800 dark:bg-purple-900/20 dark:text-purple-400",other:"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-400"})[d]||"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-400",f=d=>{switch(d){case"approved":return"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400";case"rejected":return"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-400";default:return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-400"}},w=d=>{switch(d){case"approved":return e.jsx(A,{className:"h-4 w-4"});case"rejected":return e.jsx(R,{className:"h-4 w-4"});default:return e.jsx("div",{className:"h-4 w-4 rounded-full bg-yellow-400 animate-pulse"})}},b=d=>{switch(d){case"approved":return"Approved";case"rejected":return"Rejected";default:return"Pending Approval"}};return e.jsxs(W,{children:[e.jsx(H,{title:`Expense: ${s.title}`}),e.jsxs("div",{className:"container mx-auto px-4 py-6 max-w-4xl pb-20 sm:pb-6",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx(y,{href:"/expenses",className:"flex-shrink-0 w-10 h-10 bg-gray-100 dark:bg-gray-800 rounded-full flex items-center justify-center hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors",children:e.jsx(K,{className:"h-5 w-5 text-gray-600 dark:text-gray-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900 dark:text-gray-100 truncate",children:s.title}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:n==="manager"?"Your expense details":"Expense management"})]}),e.jsx("div",{className:"flex-shrink-0",children:e.jsx(C,{className:`${f(s.status)} text-sm px-3 py-2 font-medium`,children:w(s.status)})})]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(N,{className:"border-0 shadow-sm bg-white dark:bg-gray-900 dark:border-gray-800",children:e.jsxs(v,{className:"p-6",children:[e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsxs("div",{className:"text-center sm:text-left",children:[e.jsx("div",{className:"text-2xl sm:text-3xl lg:text-4xl font-bold text-gray-900 dark:text-gray-100",children:P(s.amount)}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-500 dark:text-gray-400 mt-1",children:"Total Amount"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-3 justify-center sm:justify-start",children:[e.jsx(C,{className:`${m(s.category)} text-sm px-3 py-2 font-medium w-fit mx-auto sm:mx-0`,children:s.category}),e.jsx(C,{className:`${f(s.status)} text-sm px-3 py-2 font-medium w-fit mx-auto sm:mx-0`,children:b(s.status)})]})]}),s.description&&e.jsx("div",{className:"mb-6 p-4 bg-gray-50 dark:bg-gray-800/50 rounded-lg",children:e.jsx("p",{className:"text-gray-700 dark:text-gray-300 text-sm leading-relaxed",children:s.description})}),e.jsxs("div",{className:"space-y-3 pt-6 border-t border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-800/50 rounded-lg",children:[e.jsx("div",{className:"flex-shrink-0 w-10 h-10 bg-blue-100 dark:bg-blue-900/20 rounded-full flex items-center justify-center",children:e.jsx(G,{className:"h-5 w-5 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide mb-1",children:"Expense Date"}),e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:new Date(s.expense_date).toLocaleDateString()})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-800/50 rounded-lg",children:[e.jsx("div",{className:"flex-shrink-0 w-10 h-10 bg-gray-100 dark:bg-gray-800 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"h-5 w-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide mb-1",children:"Submitted On"}),e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:new Date(s.created_at).toLocaleDateString()})]})]})]})]})}),s.receipt_path&&e.jsx(N,{className:"border-0 shadow-sm bg-white dark:bg-gray-900 dark:border-gray-800",children:e.jsx(v,{className:"p-4 sm:p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 sm:w-12 sm:h-12 bg-green-100 dark:bg-green-900/20 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(q,{className:"h-8 w-8 sm:h-6 sm:w-6 text-green-600 dark:text-green-400"})}),e.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-900 dark:text-gray-100 mb-2",children:"Proof of Purchase"}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-600 dark:text-gray-400 mb-4 sm:mb-6",children:"Receipt or invoice available for this expense"}),e.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:gap-3 justify-center",children:[e.jsxs(x,{onClick:()=>window.open(`/expenses/${s.id}/receipt`,"_blank"),className:"bg-green-600 hover:bg-green-700 text-white w-full sm:w-auto",children:[e.jsx(J,{className:"h-4 w-4 mr-2"}),"View Proof"]}),e.jsxs(x,{variant:"outline",onClick:()=>{const d=document.createElement("a");d.href=`/expenses/${s.id}/receipt?download=true`,d.download="",d.click()},className:"border-green-300 text-green-700 hover:bg-green-50 dark:border-green-600 dark:text-green-300 dark:hover:bg-green-900/20 w-full sm:w-auto",children:[e.jsx(Me,{className:"h-4 w-4 mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Download Proof"}),e.jsx("span",{className:"sm:hidden",children:"Download"})]})]})]})})}),(s.status==="approved"||s.status==="rejected")&&s.approval_notes&&e.jsx(N,{className:`border-0 shadow-sm bg-white dark:bg-gray-900 dark:border-gray-800 ${s.status==="approved"?"border-l-4 border-l-green-500":"border-l-4 border-l-red-500"}`,children:e.jsx(v,{className:"p-4 sm:p-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-start gap-3 sm:gap-4",children:[e.jsx("div",{className:`flex-shrink-0 w-12 h-12 sm:w-10 sm:h-10 rounded-full flex items-center justify-center mx-auto sm:mx-0 ${s.status==="approved"?"bg-green-100 dark:bg-green-900/20":"bg-red-100 dark:bg-red-900/20"}`,children:s.status==="approved"?e.jsx(A,{className:"h-6 w-6 sm:h-5 sm:w-5 text-green-600 dark:text-green-400"}):e.jsx(R,{className:"h-6 w-6 sm:h-5 sm:w-5 text-red-600 dark:text-red-400"})}),e.jsxs("div",{className:"flex-1 text-center sm:text-left",children:[e.jsx("h3",{className:`text-sm font-medium mb-2 ${s.status==="approved"?"text-green-700 dark:text-green-300":"text-red-700 dark:text-red-300"}`,children:s.status==="approved"?"Approval Notes":"Rejection Reason"}),e.jsx("p",{className:`text-sm ${s.status==="approved"?"text-green-800 dark:text-green-200":"text-red-800 dark:text-red-200"}`,children:s.approval_notes}),s.approved_at&&e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2",children:[s.status==="approved"?"Approved":"Rejected"," on ",new Date(s.approved_at).toLocaleDateString()]})]})]})})}),e.jsx(N,{className:"border-0 shadow-sm bg-white dark:bg-gray-900 dark:border-gray-800",children:e.jsx(v,{className:"p-6",children:e.jsxs("div",{className:"space-y-4",children:[s.status==="pending"&&(n==="admin"||s.added_by.email==="current_user_email")&&e.jsx(y,{href:`/expenses/${s.id}/edit`,className:"w-full",children:e.jsxs(x,{variant:"outline",className:"w-full border-blue-200 text-blue-700 hover:bg-blue-50 dark:border-blue-600 dark:text-blue-300 dark:hover:bg-blue-900/20",children:[e.jsx(Re,{className:"h-4 w-4 mr-2"}),"Edit Expense"]})}),n==="admin"&&s.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsx(u,{htmlFor:"approval-notes",className:"text-sm font-medium text-green-700 dark:text-green-300 mb-3 block",children:"Approval Notes (Optional)"}),e.jsx(z,{id:"approval-notes",placeholder:"Add approval notes...",value:a,onChange:d=>c(d.target.value),className:"border-green-200 focus:border-green-300 mb-4",rows:3}),e.jsx(x,{onClick:r,disabled:i,className:"w-full bg-green-600 hover:bg-green-700 text-white py-3",children:i?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Approving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(A,{className:"h-4 w-4 mr-2"}),"Approve Expense"]})})]}),e.jsxs("div",{className:"pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsx(u,{htmlFor:"rejection-notes",className:"text-sm font-medium text-red-700 dark:text-red-300 mb-3 block",children:"Rejection Reason (Required)"}),e.jsx(z,{id:"rejection-notes",placeholder:"Provide reason for rejection...",value:o,onChange:d=>h(d.target.value),className:"border-red-200 focus:border-red-300 mb-4",rows:3}),e.jsx(x,{onClick:l,disabled:i,variant:"outline",className:"w-full border-red-200 text-red-700 hover:bg-red-50 dark:border-red-600 dark:text-red-300 dark:hover:bg-red-900/20 py-3",children:i?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-red-700 border-t-transparent rounded-full animate-spin"}),"Rejecting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(R,{className:"h-4 w-4 mr-2"}),"Reject Expense"]})})]})]}),e.jsx("div",{className:"pt-4 border-t border-gray-200 dark:border-gray-700",children:e.jsx(y,{href:"/expenses",className:"w-full",children:e.jsxs(x,{variant:"outline",className:"w-full py-3",children:[e.jsx(K,{className:"h-4 w-4 mr-2"}),"Back to Expenses"]})})})]})})})]})]})]})}const rs=Object.freeze(Object.defineProperty({__proto__:null,default:Xe},Symbol.toStringTag,{value:"Module"}));export{es as C,ss as E,ts as I,D as K,u as L,as as P,X as S,z as T,U as a,Y as b,V as c,E as d,rs as e};
